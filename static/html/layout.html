<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="/css/simplemde.min.css" />
    <link rel="stylesheet" href="/css/github.min.css" />
    <link rel="stylesheet" href="/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/css/typebase.css" />
    <link rel="stylesheet" href="/css/style.css" />

    <script src="/js/highlight.min.js" defer></script>
    <script src="/js/simplemde.min.js" defer></script>

    <meta charset="utf-8" />
    <title>{title}</title>
  </head>
  <body onload="loadTheWiki()">
    <div id="main">
      {nav} {body}
    </div>
  </body>
  <script>
    function loadTheWiki() {
      // dbl click wiki content to edit
      var editLink = document.getElementById("edit-link");
      if (editLink) {
        window.addEventListener("dblclick", function () {
          window.location = editLink.href;
        });
      }

      // ESC key to go back when editing
      // CTRL+ENTER to submit when editing
      document.onkeydown = (e) => {
        e = e || window.event || {};

        // edit page only
        if (!document.getElementById("markdown")) return;

        // escape
        if (e.keyCode == 27) history.back();

        // ctrl+enter
        if ((e.ctrlKey || e.metaKey) && e.keyCode == 13)
          document.getElementById("form").submit();
      };

      var focused = document.getElementById("focused");
      if (focused && focused.value == "") focused.focus();
      var simplemde = new SimpleMDE({
        autofocus: !focused || focused.value != "",
        autoDownloadFontAwesome: false,
        blockStyles: {
          italic: "_",
        },
        indentWithTabs: false,
        renderingConfig: {
          singleLineBreaks: false,
          codeSyntaxHighlighting: true,
        },
        status: false,
        tabSize: 4,
        element: document.getElementById("markdown"),
      });
    }
  </script>
</html>
